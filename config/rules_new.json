[
  {
    "rule_id": "rule_1",
    "description": "Checks for ability to send and receive SMS messages.",
    "target_permission": "android.permission.SEND_SMS",
    "target_class": "Landroid/telephony/SmsManager",
    "target_methods": [
      "sendTextMessage",
      "sendMultipartTextMessage",
      "sendDataMessage"
    ]
  },
  {
    "rule_id": "rule_2",
    "description": "Checks for ability to record audio using microphone.",
    "target_permission": "android.permission.RECORD_AUDIO",
    "target_class": "Landroid/media/MediaRecorder",
    "target_methods": [
      "start",
      "setAudioSource",
      "prepare",
      "stop"
    ]
  },
  {
    "rule_id": "rule_3",
    "description": "Checks for ability to capture screen content and record screen.",
    "target_permission": "android.permission.FOREGROUND_SERVICE",
    "target_class": "Landroid/media/projection/MediaProjectionManager",
    "target_methods": [
      "createScreenCaptureIntent"
    ]
  },
  {
    "rule_id": "rule_4",
    "description": "Checks for ability to access and intercept notifications.",
    "target_permission": "android.permission.BIND_NOTIFICATION_LISTENER_SERVICE",
    "target_class": "Landroid/service/notification/NotificationListenerService",
    "target_methods": [
      "onNotificationPosted",
      "onNotificationRemoved"
    ]
  },
  {
    "rule_id": "rule_5",
    "description": "Checks for web browsing and internet access capabilities.",
    "target_permission": "android.permission.INTERNET",
    "target_class": "Landroid/webkit/WebView",
    "target_methods": [
      "loadUrl",
      "evaluateJavascript"
    ]
  },
  {
    "rule_id": "rule_6",
    "description": "Checks for ability to read and write clipboard data.",
    "target_permission": "android.permission.READ_CLIPBOARD",
    "target_class": "Landroid/content/ClipboardManager",
    "target_methods": [
      "getPrimaryClip",
      "setPrimaryClip",
      "getText"
    ]
  },
  {
    "rule_id": "rule_7",
    "description": "Checks for ability to access device location services.",
    "target_permission": "android.permission.ACCESS_FINE_LOCATION",
    "target_class": "Landroid/location/LocationManager",
    "target_methods": [
      "requestLocationUpdates",
      "getLastKnownLocation"
    ]
  },
  {
    "rule_id": "rule_8",
    "description": "Checks for accessibility service usage for persistence and control.",
    "target_permission": "android.permission.BIND_ACCESSIBILITY_SERVICE",
    "target_class": "Landroid/accessibilityservice/AccessibilityService",
    "target_methods": [
      "performGlobalAction"
    ]
  },
  {
    "rule_id": "rule_9",
    "description": "Detects usage of reflection (Class.forName, getDeclaredMethod, Method.invoke).",
    "target_permission": [],
    "target_classes": [
      {
        "class": "Ljava/lang/Class",
        "methods": [
          "forName",
          "getDeclaredMethod"
        ]
      },
      {
        "class": "Ljava/lang/reflect/Method",
        "methods": [
          "invoke"
        ]
      }
    ]
  },
  {
    "rule_id": "rule_10",
    "description": "Detects keylogging attempts using Accessibility Service.",
    "target_permission": "android.permission.BIND_ACCESSIBILITY_SERVICE",
    "target_class": "Landroid/accessibilityservice/AccessibilityService",
    "target_methods": [
      "getEventType",
      "getSource",
      "getText"
    ]
  },
  {
    "rule_id": "rule_11",
    "description": "Detects notification interception, tapping, and deceptive notifications.",
    "target_permission": "android.permission.BIND_NOTIFICATION_LISTENER_SERVICE",
    "target_class": "Landroid/service/notification/NotificationListenerService",
    "target_methods": [
      "onNotificationPosted",
      "getActiveNotifications",
      "getNotification",
      "send",
      "cancelNotification",
      "setContentTitle",
      "setContentText",
      "setSmallIcon",
      "setContentIntent"
    ]
  },
  {
    "rule_id": "rule_12",
    "description": "Detects overlay attacks using WindowManager.",
    "target_permission": "android.permission.SYSTEM_ALERT_WINDOW",
    "target_class": "Landroid/view/WindowManager",
    "target_methods": [
      "getSystemService",
      "addView",
      "updateViewLayout",
      "removeView"
    ]
  },
  {
    "rule_id": "rule_13",
    "description": "Detects dynamic code loading through DexClassLoader.",
    "target_permission": "android.permission.INTERNET",
    "target_class": "Ldalvik/system/DexClassLoader",
    "target_methods": [
      "forName",
      "getMethod",
      "invoke",
      "addJavascriptInterface",
      "loadLibrary"
    ]
  },
  {
    "rule_id": "rule_14",
    "description": "Detects runtime file encryption/decryption.",
    "target_permission": [
      "android.permission.READ_EXTERNAL_STORAGE",
      "android.permission.WRITE_EXTERNAL_STORAGE",
      "android.permission.MANAGE_EXTERNAL_STORAGE",
      "android.permission.FOREGROUND_SERVICE"
    ],
    "target_class": "Ljavax/crypto/Cipher",
    "target_methods": [
      "getInstance",
      "init",
      "doFinal",
      "generateKey",
      "generateKeyPair",
      "listFiles",
      "walk"
    ]
  },
  {
    "rule_id": "rule_15",
    "description": "Detects installation of secondary payload APKs (dropper) - permission only.",
    "target_permission": "android.permission.REQUEST_INSTALL_PACKAGES"
  },
  {
    "rule_id": "rule_16",
    "description": "Checks for the ability to execute arbitrary JavaScript and exfiltrate data from WebViews. This is a primary method for stealing session info and credentials via overlay attacks.",
    "target_permission": "android.permission.INTERNET",
    "target_class": "Landroid/webkit/WebView",
    "target_methods": [
      "addJavascriptInterface",
      "loadUrl",
      "evaluateJavascript",
      "postWebMessage"
    ]
  },
  {
    "rule_id": "rule_17",
    "description": "Checks for direct access to and manipulation of cookies. This is a key indicator for session hijacking.",
    "target_permission": "android.permission.INTERNET",
    "target_class": "Landroid/webkit/CookieManager",
    "target_methods": [
      "getCookie",
      "setCookie",
      "removeAllCookies",
      "flush"
    ]
  },
  {
    "rule_id": "rule_18",
    "description": "Detects Gmail access attempts through WebView manipulation and cookie theft.",
    "target_permission": [
      "android.permission.GET_ACCOUNTS",
      "android.permission.USE_CREDENTIALS",
      "android.permission.INTERNET"
    ],
    "target_classes": [
      "Landroid/view/WindowManager",
      "Landroid/webkit/WebView",
      "Landroid/webkit/CookieManager"
    ],
    "target_methods": [
      "addView",
      "loadUrl",
      "addJavascriptInterface",
      "getCookie"
    ],
    "rule_type": "multi_class_all_methods"
  },
  {
    "rule_id": "rule_19",
    "description": "Detects malicious intent strings commonly used by malware for persistence and monitoring.",
    "target_strings": [
      "android.intent.action.BOOT_COMPLETED",
      "android.provider.Telephony.SMS_RECEIVED",
      "android.intent.action.NEW_OUTGOING_CALL",
      "android.intent.action.PHONE_STATE",
      "android.intent.action.USER_PRESENT",
      "android.net.conn.CONNECTIVITY_CHANGE",
      "android.intent.action.SCREEN_OFF",
      "android.intent.action.SCREEN_ON",
      "android.intent.action.PACKAGE_ADDED",
      "android.intent.action.PACKAGE_REMOVED",
      "android.intent.action.PACKAGE_REPLACED",
      "android.media.RINGER_MODE_CHANGED",
      "android.provider.Telephony.SMS_SENT",
      "android.provider.Telephony.SMS_DELIVERED",
      "android.settings.ACCESSIBILITY_SETTINGS",
      "android.intent.action.CALL",
      "com.google.android.gm.READ_EMAIL"
    ],
    "rule_type": "string_detection"
  },
  {
    "rule_id": "rule_20",
    "description": "Detects audio recording capabilities using MediaRecorder and AudioRecord.",
    "target_permission": "android.permission.RECORD_AUDIO",
    "target_classes": [
      "Landroid/media/MediaRecorder",
      "Landroid/media/AudioRecord"
    ],
    "target_methods": [
      "start",
      "stop",
      "getMaxAmplitude"
    ],
    "rule_type": "multi_class_methods"
  },
  {
    "rule_id": "rule_21",
    "description": "Detects apps without proper main launcher activity - potential background malware.",
    "manifest_check": {
      "activity_name": ".MainActivity",
      "intent_action": "android.intent.action.MAIN",
      "intent_category": "android.intent.category.LAUNCHER"
    },
    "rule_type": "manifest_absence"
  },
  {
    "rule_id": "rule_22",
    "description": "Detects potential backdoor implementations using network sockets and HTTP clients.",
    "target_classes": [
      {
        "class": "Ljava/net/Socket",
        "methods": ["connect", "getInputStream", "getOutputStream"]
      },
      {
        "class": "Ljava/net/HttpURLConnection",
        "methods": ["openConnection"]
      },
      {
        "class": "Lokhttp3/OkHttpClient",
        "methods": ["newCall", "execute"]
      }
    ],
    "rule_type": "multi_class_methods"
  },
  {
    "rule_id": "rule_23",
    "description": "Detects usage of biometric authentication APIs and accessibility service abuse.",
    "target_classes": [
      {
        "class": "Landroid/hardware/biometrics/BiometricPrompt",
        "methods": ["authenticate"]
      },
      {
        "class": "Landroid/hardware/fingerprint/FingerprintManager",
        "methods": ["authenticate"]
      },
      {
        "class": "Landroid/accessibilityservice/AccessibilityService",
        "methods": ["performAction"]
      }
    ],
    "rule_type": "multi_class_methods"
  },
  {
    "rule_id": "rule_24",
    "description": "Detects attempts to disable Play Protect or tamper with package management.",
    "target_classes": [
      {
        "class": "Landroid/provider/Settings",
        "methods": ["ACTION_SECURITY_SETTINGS"]
      },
      {
        "class": "Landroid/content/pm/PackageManager",
        "methods": ["getPackageInfo", "getInstalledPackages"]
      },
      {
        "class": "Landroid/content/Intent",
        "methods": []
      }
    ],
    "rule_type": "multi_class_methods"
  },
  {
    "rule_id": "rule_25",
    "description": "Detects credential theft attempts via overlay attacks and WebView injection.",
    "target_classes": [
      {
        "class": "Landroid/view/WindowManager",
        "methods": ["addView", "removeView"]
      },
      {
        "class": "Landroid/webkit/WebView",
        "methods": ["loadUrl", "addJavascriptInterface"]
      }
    ],
    "rule_type": "multi_class_methods"
  },
  {
    "rule_id": "rule_26",
    "description": "Detects call forwarding and call log abuse.",
    "target_classes": [
      {
        "class": "Landroid/provider/CallLog$Calls",
        "methods": ["query"]
      },
      {
        "class": "Landroid/telecom/TelecomManager",
        "methods": ["placeCall"]
      }
    ],
    "rule_type": "multi_class_methods"
  },
  {
    "rule_id": "rule_27",
    "description": "Detects apps using more than 4 databases (suspicious data storage).",
    "rule_type": "database_count",
    "threshold": 4
  }
]
